<!DOCTYPE html> 
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="google-site-verification" content="fB00vw3NhrcDODZ6PcjUHM1Pz1j4T-eZ0Ja7ffDx-aU" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="alternate" href="/index.xml" type="application/rss+xml" title="Welcome to Hello World">
    <link rel="icon" href="https://harryho.github.io/favicon.ico">
    <title>Use Windows command &amp; hotkey as a hacker - Part 2 - Welcome to Hello World</title>
    
    <link rel="stylesheet" href="https://harryho.github.io/css/highlight/railscasts.css">
    <link rel="stylesheet" href="https://harryho.github.io/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://harryho.github.io/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="https://harryho.github.io/css/theme.css">
    <link rel="stylesheet" href="https://harryho.github.io/css/bootie-docs.css">
</head>

<body role="document">
    
    <nav class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="https://harryho.github.io/">Welcome to Hello World</a>
            </div>
            <div id="navbar" class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li ><a href="https://harryho.github.io/">Home</a></li>
                       
                    <li ><a href="https://harryho.github.io/blog/">Blog</a></li>
                     
                    <li ><a href="https://harryho.github.io/project/">Project</a></li>
                     
                    <li ><a href="https://harryho.github.io/index/">Index</a></li>
                      
                </ul>
                
                <form class="navbar-form navbar-left" role="search" action="https://www.google.co.jp/search" method="get">
                    <div class="input-group doc-search-form">
                        <input type="hidden" name="as_sitesearch" value="harryho.github.io">
                        <input type="text" name="as_q" class="search-query doc-search-input-text" placeholder="Search Site">
                        <span class="input-group-addon input-group-btn doc-search-input-btn " >
							<button class="btn" type="submit"><span class="glyphicon glyphicon-search"></span></button>
                        </span>
                    </div>
                </form>
                
            </div>
            
        </div>
    </nav>
    <div class="container">


<div class="row">
	<div class="col-sm-8 doc-main">
		<main role="main">
			<article>
				<a id="title"></a>
				<h1 class="doc-entry-title">Use Windows command &amp; hotkey as a hacker - Part 2</h1>
				<div class="doc-entry-meta">
					<span>updated at <time datetime="2014-03-24">24 Mar 2014</time></span>
				</div>
				<section>
					

<p><em>This article will continue the topic of Windows command &amp; hotkeys. Part-1 shows you common hotkeys and short command lines for <code>Run</code> windnow dialog. The rest of this topic will focus on the advanced commands and how to create a batch script with all those commands.</em></p>

<p><em>Let me clarify something first. Advanced command here does not mean that commands here are very complicated or much more powerful than common ones, which have been shown in the Part-1. Here we call them advanced, because they are used by experienced users to complete their given tasks, and those commands are used seldom by majority people. Comparing with Part-1, advanced commands have some specific features which allow them to do some special jobs, which usually are done by system admin. Advanced command is known as Admin command as well.</em></p>

<h2 id="advanced-commands-and-usages">Advanced commands and usages</h2>

<h3 id="attrib">attrib</h3>

<ul>
<li>Type <code>attrib +h a.txt</code> to hide file and use <code>attrib -h a.txt</code> to unhide it.</li>
<li>Type <code>attrib +r a.txt</code> to change file to read-only and reverse the action by <code>-r</code></li>
</ul>

<h3 id="env">env</h3>

<ul>
<li>Type <code>env&gt;env.txt &amp; notepad env.txt</code> Display all environment variable in text file</li>
</ul>

<h3 id="set">set</h3>

<ul>
<li>Type <code>set path</code> to display <strong>PATH</strong> environment variable, which is useful to check if your <strong>PATH</strong> has been setup properly.</li>
<li>Type <code>set /P a=b</code> to set b as value to variable a. It will be used in bat/cmd script.</li>
</ul>

<h3 id="net">net</h3>

<p><strong>get sub-commands</strong> &ndash; type <code>net /?</code></p>

<pre><code class="language-bash">    [ ACCOUNTS | COMPUTER | CONFIG | CONTINUE | FILE | GROUP | HELP |
     HELPMSG | LOCALGROUP | PAUSE | SESSION | SHARE | START | 
     STATISTICS | STOP | TIME | USE | USER | VIEW ]
</code></pre>

<p><strong>get sub-command&rsquo;s help</strong> &ndash; type <code>net [sub-command] /?</code></p>

<p><strong>net view</strong></p>

<ul>
<li>Use <code>net view</code> to show a list of computers and network devices on the network.</li>
</ul>

<p><strong>net statistics</strong></p>

<ul>
<li>Use <code>net statistics workstation(/server)</code> to show the network statistics log for the Server or Workstation service</li>
</ul>

<p><strong>net localgroup</strong></p>

<ul>
<li>Use <code>net localgroup</code> to show a list of local user group on your computer.</li>
</ul>

<p><strong>net user</strong></p>

<ul>
<li>Type <code>net user %username%</code> to retrieve your user information</li>
<li>Type <code>net user adminstrator</code> to check the status of administrator</li>
<li>Type <code>net user administrator /active:yes</code> to activate adminstrator and inactivate by replacing <code>yes</code> with<code>no</code></li>
</ul>

<p><strong>net accounts</strong></p>

<ul>
<li>Use<code>net accounts &lt;user&gt;</code> to show current user&rsquo;s password and login requirement.</li>
<li>Use<code>net accounts &lt;user&gt; /minpwlen:6</code> to set password minimum length requirement for user.</li>
<li>Use<code>net accounts &lt;user&gt; /maxpwage:30</code> to force user to reset password every 30 days, or use <code>unlimited</code> to replace the number <code>30</code>, then user&rsquo;s password will never expire.</li>
<li>User<code>net accounts /unique:5</code> to prevent user reuse previous passwords, and default value is 5.</li>
</ul>

<h3 id="runas">runas</h3>

<pre><code class="language-bash">runas /user:yourpc\administrator &quot;cmd&quot;
runas /user:yourpc\administrator &quot;cmd /C type \&quot;\&quot;&gt;c:\z.txt &amp; dir c:\z.txt &amp; pause &amp; del c:\z.txt &quot;
</code></pre>

<h3 id="tasklist">tasklist</h3>

<ul>
<li>tasklist[.exe] [/s computer] [/u domain\user [/p password]] [/fo {TABLE|LIST|CSV}] [/nh] [/fi FilterName [/fi FilterName2 [ &hellip; ]]] [/m [ModuleName] | /svc | /v</li>
<li>FilterName: Status, Imagename,</li>
<li>Find process by pid</li>
</ul>

<pre><code class="language-bash">tasklist /v /fo list /fi &quot;imagename eq mysqld.exe&quot;
tasklist /v /fo list /fi &quot;imagename eq mongod.exe&quot;
tasklist /fi &quot;USERNAME ne NT AUTHORITY\SYSTEM&quot; /fi &quot;STATUS eq running&quot; 
tasklist /fi &quot;USERNAME ne NT AUTHORITY\SYSTEM&quot; /fi &quot;STATUS eq not responding&quot; 
tasklist /fi &quot;pid eq 4444&quot;
</code></pre>

<h3 id="taskkill">taskkill</h3>

<h3 id="sc">sc</h3>

<ul>
<li>Query Service</li>
</ul>

<pre><code>sc query &lt;servicename&gt;
sc query state= all | find &quot;SERVICE_NAME&quot; 
</code></pre>

<ul>
<li><p>Retrieve service name and state. type parameter can be used twice in some case.
**state= {active | inactive | all}
**type= {driver | service | all}
**type= {own | share | interact | kernel | filesys | rec | adapt}</p></li>

<li><p>Note: If you run this inside a batch file, the percent signs (e.g. at %s) need to be doubled</p></li>
</ul>

<pre><code>sc query state= inactive type= driver type= kernel
for /f &quot;tokens=2&quot; %s in ('sc query state^= all ^| find &quot;SERVICE_NAME&quot;') do @echo %s    
for /f &quot;tokens=2&quot; %s in ('sc query state^= all ^| find &quot;SERVICE_NAME&quot;') do @(
    for /f &quot;tokens=4&quot; %t in ('sc query %s ^| find &quot;STATE     &quot;') do @echo %s -- %t
    )
</code></pre>

<ul>
<li>Start or stop service
<code>
sc start  &lt;servicename&gt;
sc stop  &lt;servicename&gt;
</code></li>
</ul>

<h3 id="netstat">netstat</h3>

<pre><code class="language-bash">netstat -ano | find &quot;:80&quot; 
</code></pre>

<h3 id="ipconfig">ipconfig</h3>

				</section>
			</article>
		</main>
	</div> 

	

<div class="col-sm-3 col-sm-offset-1 doc-sidebar">
	<div id="sidebar">
	<div class="sidebar-module">
		<div class="sidebar-toc">
			<h4 class="sidebar-heading">Table of Contents</h4>
			<ul>
				<li><strong><a href="#title">Use Windows command &amp; hotkey as a hacker - Part 2</a></strong></li>
			</ul>
			<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#advanced-commands-and-usages">Advanced commands and usages</a>
<ul>
<li><a href="#attrib">attrib</a></li>
<li><a href="#env">env</a></li>
<li><a href="#set">set</a></li>
<li><a href="#net">net</a></li>
<li><a href="#runas">runas</a></li>
<li><a href="#tasklist">tasklist</a></li>
<li><a href="#taskkill">taskkill</a></li>
<li><a href="#sc">sc</a></li>
<li><a href="#netstat">netstat</a></li>
<li><a href="#ipconfig">ipconfig</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
		</div>
	</div>
	<div class="sidebar-module">
		<h4 class="sidebar-heading">Pages in Categories</h4>
		<ul class="sidebar-category-list">
		
			<li>
				<a href="https://harryho.github.io/categories/blog">
					<span class="doc-list-category">Blog</span>
				</a>
				<ul>
					<li><a href="/blog/create-a-blog-on-github-pages/">Create a blog site on GitHub Pages within Windows environment</a>
					</li>
				
					<li>
						<span class="active">Use Windows command &amp; hotkey as a hacker - Part 2</span>
						</li>
				
					<li><a href="/blog/use-windows-command-hotkey-as-hacker-1/">Use Windows command &amp; hotkey as a hacker - Part 1</a>
					</li>
				
					<li><a href="/blog/better-practice-in-java-1/">Better practice in Java - Part 1</a>
					</li>
				
				</ul>
			</li>
		
			<li>
				<a href="https://harryho.github.io/categories/project">
					<span class="doc-list-category">Project</span>
				</a>
				<ul>
					<li><a href="/project/angularjs-webpack-es6-starter/">Angularjs Webpack ES6 Starter</a>
					</li>
				
				</ul>
			</li>
		
		</ul>
	</div>
	<div class="sidebar-module">
		<h4 class="sidebar-heading">Tags</h4>
		<div class="tag-box">
		
			<a class="tag-item" href="https://harryho.github.io/tags/angularjs">angularjs</a>
		
			<a class="tag-item" href="https://harryho.github.io/tags/cmd">cmd</a>
		
			<a class="tag-item" href="https://harryho.github.io/tags/git">git</a>
		
			<a class="tag-item" href="https://harryho.github.io/tags/hugo">hugo</a>
		
			<a class="tag-item" href="https://harryho.github.io/tags/java">java</a>
		
			<a class="tag-item" href="https://harryho.github.io/tags/javascript">javascript</a>
		
			<a class="tag-item" href="https://harryho.github.io/tags/webpack">webpack</a>
		
			<a class="tag-item" href="https://harryho.github.io/tags/windows">windows</a>
		
		</div>
	</div>
	</div>
</div>

</div> 


<hr />

<div class="row">
	<div class="col-sm-8">
		<p class="doc-footer-em"><a href="#" onclick="resetSidebarPos()">Back to TOP</a></p>
	</div>
</div>

</div> 

<footer class="doc-footer">
	<p class="doc-footer-em">Browse <strong><a href="https://github.com/harryho/harryho.github.io.git">Repository</a></strong></p>
	<p>Copyright (c) 2015, harryho; All rights reserved.</p>
	<p>Powered by <strong><a href="https://github.com/key-amb/hugo-theme-bootie-docs">Bootie Docs</a></strong> - theme for <a href="http://gohugo.io/">Hugo</a> by <a href="https://github.com/key-amb/">key-amb</a>.</p>
</footer>



<script src="https://harryho.github.io/js/jquery.min.js"></script>
<script src="https://harryho.github.io/js/bootstrap.min.js"></script>

<script src="https://harryho.github.io/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="https://harryho.github.io/js/ie10-viewport-bug-workaround.js"></script>
<script src="https://harryho.github.io/js/bootie-docs.js"></script>

</body>
</html>
