<!DOCTYPE html>
<html>
  <head>
    <title>Hello World</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="revised" content="2019-01-13T02:15:58 AEDT">
<title>C# Note - 2 :: Hello World</title>
<link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link href="/css/font-awesome.min.css" rel="stylesheet">
<link href="/css/nucleus.css" rel="stylesheet">
<link href="/theme-flex/style.css" rel="stylesheet">

	<link href="/theme-flex/variant-gray.css" rel="stylesheet">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<script src="/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "\/";
</script>
<meta name="description" content="How to build a configurable scheduled task on Window Service?">



    
  </head>
  <body data-url="/code/c-sharp/csharp-note-2/">
    
      <header>
  <div class="logo">
    
  
    
        <a class="baselink" href="/">Hello World </a>
    
    
 
    
  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
  <nav class="shortcuts">
  <div>
    <div class="searchbox">
      <input data-search-input id="search-by" type="text" placeholder="Search...">
    </div>
    <script type="text/javascript" src="/js/lunr.min.js"></script>
    <script type="text/javascript" src="/js/auto-complete.js"></script>
    <link href="/css/auto-complete.css" rel="stylesheet">
    <script type="text/javascript">
      
          var baseurl = "\/";
      
    </script>
    <script type="text/javascript" src="/js/search.js"></script>
  </div>
  </nav>


</header>
<article>
  <aside>
    <ul class="menu">
          <li data-nav-id="/" class="dd-item">
          <a href="/">
            <i class="fa fa-fw fa-home"></i>
          </a>
          </li>
    <li data-nav-id="/blog/" class="dd-item haschildren
        ">
      <div>
      <a href="/blog/">Blog</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/blog/vue-ng-react/" class="dd-item">
        <div>
          <a href="/blog/vue-ng-react/">
            Angular vs React vs Vue
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/azure-notes/" class="dd-item">
        <div>
          <a href="/blog/azure-notes/">
            Azure notes
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/build-mobile-app/" class="dd-item">
        <div>
          <a href="/blog/build-mobile-app/">
            Build mobile app with web dev skills
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/create-a-blog-on-github-pages/" class="dd-item">
        <div>
          <a href="/blog/create-a-blog-on-github-pages/">
            Create a blog site on GitHub Pages
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/jira-notes/" class="dd-item">
        <div>
          <a href="/blog/jira-notes/">
            JIRA Notes
          </a>
        </div>
    </li>
      <li data-nav-id="/blog/javascript-oop/" class="dd-item">
        <div>
          <a href="/blog/javascript-oop/">
            JavaScript and OOP
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/code/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/code/">Coding</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
    <li data-nav-id="/code/c/" class="dd-item haschildren
        ">
      <div>
      <a href="/code/c/">C / C&#43;&#43;</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/code/c/lcthw-lectures.1/" class="dd-item">
        <div>
          <a href="/code/c/lcthw-lectures.1/">
            C Lecture - 1
          </a>
        </div>
    </li>
      <li data-nav-id="/code/c/lcthw-lectures.2/" class="dd-item">
        <div>
          <a href="/code/c/lcthw-lectures.2/">
            C Lecture - 2
          </a>
        </div>
    </li>
      <li data-nav-id="/code/c/lcthw-lectures.3/" class="dd-item">
        <div>
          <a href="/code/c/lcthw-lectures.3/">
            C Lecture - 3
          </a>
        </div>
    </li>
      <li data-nav-id="/code/c/lcthw-lectures.4/" class="dd-item">
        <div>
          <a href="/code/c/lcthw-lectures.4/">
            C Lecture - 4
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/code/c-sharp/" class="dd-item parent haschildren
        ">
      <div>
      <a href="/code/c-sharp/">C#</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/code/c-sharp/csharp-note-1/" class="dd-item">
        <div>
          <a href="/code/c-sharp/csharp-note-1/">
            C# Note - 1
          </a>
        </div>
    </li>
      <li data-nav-id="/code/c-sharp/csharp-note-2/" class="dd-item active">
        <div>
          <a href="/code/c-sharp/csharp-note-2/">
            C# Note - 2
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/code/java/" class="dd-item haschildren
        ">
      <div>
      <a href="/code/java/">Java</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/code/java/java-note-1/" class="dd-item">
        <div>
          <a href="/code/java/java-note-1/">
            Java Note - 1: Enum
          </a>
        </div>
    </li>
      <li data-nav-id="/code/java/java-note-2/" class="dd-item">
        <div>
          <a href="/code/java/java-note-2/">
            Java Note - 2: Concurrency
          </a>
        </div>
    </li>
      <li data-nav-id="/code/java/java-note-3/" class="dd-item">
        <div>
          <a href="/code/java/java-note-3/">
            Java Note - 3: Path and Files API
          </a>
        </div>
    </li>
      <li data-nav-id="/code/java/java-note-4/" class="dd-item">
        <div>
          <a href="/code/java/java-note-4/">
            Java Note - 4: Date Time API 
          </a>
        </div>
    </li>
      <li data-nav-id="/code/java/java-note-5/" class="dd-item">
        <div>
          <a href="/code/java/java-note-5/">
            Java Note - 5: Lambda API 
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/code/python/" class="dd-item haschildren
        ">
      <div>
      <a href="/code/python/">Python</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/code/python/python-note-1/" class="dd-item">
        <div>
          <a href="/code/python/python-note-1/">
            Python Notes - 1
          </a>
        </div>
    </li>
      <li data-nav-id="/code/python/python-note-2/" class="dd-item">
        <div>
          <a href="/code/python/python-note-2/">
            Python Notes - 2
          </a>
        </div>
    </li>
      <li data-nav-id="/code/python/python-note-3/" class="dd-item">
        <div>
          <a href="/code/python/python-note-3/">
            Python Notes - 3
          </a>
        </div>
    </li>
      <li data-nav-id="/code/python/python-note-4/" class="dd-item">
        <div>
          <a href="/code/python/python-note-4/">
            Python Notes - 4
          </a>
        </div>
    </li>
      <li data-nav-id="/code/python/python-note-5/" class="dd-item">
        <div>
          <a href="/code/python/python-note-5/">
            Python Notes - 5
          </a>
        </div>
    </li>
      <li data-nav-id="/code/python/python-note-6/" class="dd-item">
        <div>
          <a href="/code/python/python-note-6/">
            Python Notes - 6
          </a>
        </div>
    </li>
      <li data-nav-id="/code/python/python-note-7/" class="dd-item">
        <div>
          <a href="/code/python/python-note-7/">
            Python Notes - 7
          </a>
        </div>
    </li>
      <li data-nav-id="/code/python/python-note-8/" class="dd-item">
        <div>
          <a href="/code/python/python-note-8/">
            Python Notes - 8
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/code/shell/" class="dd-item haschildren
        ">
      <div>
      <a href="/code/shell/">Shell</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/code/shell/ps-note-1/" class="dd-item">
        <div>
          <a href="/code/shell/ps-note-1/">
            Powershell Notes - 1
          </a>
        </div>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/dev/" class="dd-item haschildren
        ">
      <div>
      <a href="/dev/">Dev</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/dev/cntk-notes-1/" class="dd-item">
        <div>
          <a href="/dev/cntk-notes-1/">
            CNTK Notes - 1
          </a>
        </div>
    </li>
      <li data-nav-id="/dev/php-debug/" class="dd-item">
        <div>
          <a href="/dev/php-debug/">
            Debug PHP with Eclipse PDT and Netbeans
          </a>
        </div>
    </li>
      <li data-nav-id="/dev/git-notes/" class="dd-item">
        <div>
          <a href="/dev/git-notes/">
            Git Notes
          </a>
        </div>
    </li>
      <li data-nav-id="/dev/php-web/" class="dd-item">
        <div>
          <a href="/dev/php-web/">
            Introduction of PHP Web Framework
          </a>
        </div>
    </li>
      <li data-nav-id="/dev/python-django/" class="dd-item">
        <div>
          <a href="/dev/python-django/">
            Python Web framework
          </a>
        </div>
    </li>
      <li data-nav-id="/dev/tensorflow-notes-2/" class="dd-item">
        <div>
          <a href="/dev/tensorflow-notes-2/">
            Tensorflow Notes - 2
          </a>
        </div>
    </li>
      <li data-nav-id="/dev/tensorflow-notes-1/" class="dd-item">
        <div>
          <a href="/dev/tensorflow-notes-1/">
            Tensorflow Notes, Part 1
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/os/" class="dd-item haschildren
        ">
      <div>
      <a href="/os/">OS</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/os/centos-fedora-desktop/" class="dd-item">
        <div>
          <a href="/os/centos-fedora-desktop/">
            CentOS 6/7 Multi-Boot Setup
          </a>
        </div>
    </li>
      <li data-nav-id="/os/centos-server-7/" class="dd-item">
        <div>
          <a href="/os/centos-server-7/">
            CentOS 7 Server note
          </a>
        </div>
    </li>
      <li data-nav-id="/os/grub-trouble-shooting/" class="dd-item">
        <div>
          <a href="/os/grub-trouble-shooting/">
            Grub Trouble Shooting
          </a>
        </div>
    </li>
      <li data-nav-id="/os/lubuntu16-desktop/" class="dd-item">
        <div>
          <a href="/os/lubuntu16-desktop/">
            Lubuntu 16 desktop
          </a>
        </div>
    </li>
      <li data-nav-id="/os/raspberrypi-notes/" class="dd-item">
        <div>
          <a href="/os/raspberrypi-notes/">
            Raspberry Pi setup
          </a>
        </div>
    </li>
      <li data-nav-id="/os/ubuntu-desktop-14/" class="dd-item">
        <div>
          <a href="/os/ubuntu-desktop-14/">
            Ubuntu 14 -- desktop setup &amp; dual boot 
          </a>
        </div>
    </li>
      <li data-nav-id="/os/ubuntu-desktop-14-extra-tools/" class="dd-item">
        <div>
          <a href="/os/ubuntu-desktop-14-extra-tools/">
            Ubuntu 14 -- desktop, extra tools
          </a>
        </div>
    </li>
      <li data-nav-id="/os/ubuntu-server-14/" class="dd-item">
        <div>
          <a href="/os/ubuntu-server-14/">
            Ubuntu 14 -- server setup
          </a>
        </div>
    </li>
      <li data-nav-id="/os/ubuntu-server-16/" class="dd-item">
        <div>
          <a href="/os/ubuntu-server-16/">
            Ubuntu 16 server note
          </a>
        </div>
    </li>
      <li data-nav-id="/os/use-windows-command-hotkey-as-hacker-1/" class="dd-item">
        <div>
          <a href="/os/use-windows-command-hotkey-as-hacker-1/">
            Use Windows command &amp; hotkey as a hacker - Part 1
          </a>
        </div>
    </li>
      <li data-nav-id="/os/use-windows-command-hotkey-as-hacker-2/" class="dd-item">
        <div>
          <a href="/os/use-windows-command-hotkey-as-hacker-2/">
            Use Windows command &amp; hotkey as a hacker - Part 2
          </a>
        </div>
    </li>
      <li data-nav-id="/os/use-windows-command-hotkey-as-hacker-3/" class="dd-item">
        <div>
          <a href="/os/use-windows-command-hotkey-as-hacker-3/">
            Use Windows command &amp; hotkey as a hacker - Part 3
          </a>
        </div>
    </li>
        </ul>
    </li>
    <li data-nav-id="/project/" class="dd-item haschildren
        ">
      <div>
      <a href="/project/">Projects</a><i class="fa fa-angle-right fa-lg category-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/project/reetek-angular4-crm/" class="dd-item">
        <div>
          <a href="/project/reetek-angular4-crm/">
            Angular 4 Crm Project
          </a>
        </div>
    </li>
      <li data-nav-id="/project/angularjs-webpack-es6-starter/" class="dd-item">
        <div>
          <a href="/project/angularjs-webpack-es6-starter/">
            Angularjs Webpack ES6 Starter
          </a>
        </div>
    </li>
      <li data-nav-id="/project/python-flat-api/" class="dd-item">
        <div>
          <a href="/project/python-flat-api/">
            FlatApi -- A handy Restful API for python developer
          </a>
        </div>
    </li>
      <li data-nav-id="/project/laravel-mvc-starter/" class="dd-item">
        <div>
          <a href="/project/laravel-mvc-starter/">
            Laravel MVC Starter
          </a>
        </div>
    </li>
      <li data-nav-id="/project/reetek-react-crm/" class="dd-item">
        <div>
          <a href="/project/reetek-react-crm/">
            React Redux Crm Project
          </a>
        </div>
    </li>
      <li data-nav-id="/project/reetek-vue2-admin/" class="dd-item">
        <div>
          <a href="/project/reetek-vue2-admin/">
            Vue 2 Admin Project
          </a>
        </div>
    </li>
      <li data-nav-id="/project/reetek-vue2-crm/" class="dd-item">
        <div>
          <a href="/project/reetek-vue2-crm/">
            Vue 2 Crm Project
          </a>
        </div>
    </li>
      <li data-nav-id="/project/zf2-mvc-starter/" class="dd-item">
        <div>
          <a href="/project/zf2-mvc-starter/">
            Zendframework 2 MVC Starter
          </a>
        </div>
    </li>
        </ul>
    </li>




    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/blog/" >
   Blog</option>
    <option value="/code/" >
   Coding</option> 
    <option value="/code/c/" >
   C / C&#43;&#43;</option>
    <option value="/code/c-sharp/" >
   C#</option> 
      <option value="/code/c-sharp/csharp-note-1/" > C# Note - 1</option>
      <option value="/code/c-sharp/csharp-note-2/"  selected> C# Note - 2</option>
  
    <option value="/code/java/" >
   Java</option>
    <option value="/code/python/" >
   Python</option>
    <option value="/code/shell/" >
   Shell</option>
  
    <option value="/dev/" >
   Dev</option>
    <option value="/os/" >
   OS</option>
    <option value="/project/" >
   Projects</option>



        </select>
      </center>
    </div>

   

    <h1>C# Note - 2</h1>
    
    
    
    

<h4 id="problem">Problem</h4>

<blockquote>
<p><em>Set up the some scheduled tasks running in the backgroud to take care of data update or sync for every 15 mins, or everyday or every week</em></p>
</blockquote>

<h4 id="solution">Solution</h4>

<h5 id="option-1">Option 1</h5>

<h4 id="windows-task-scheduler">Windows Task Scheduler</h4>

<ul>
<li>Click the Start button.</li>
<li>Click Control Panel.</li>
<li>Click System and Maintenance.</li>
<li>Click Administrative Tools.</li>
<li>Double-click Task Scheduler.</li>
</ul>

<h5 id="option-2">Option 2</h5>

<h4 id="use-window-service-as-task-scheduler">Use Window Service as task scheduler</h4>

<h5 id="overview-of-design">Overview of design</h5>

<p><strong>The design here is a simplified version, which I built for previous projects. In the real world, I need to tailor it for different project with different purpose, but fundamental design of architect is the same. IMO, the design below can support most cases, which needs scheduled backgroud task service.</strong></p>

<pre><code class="language-ini">
        +----------------------------------+          Register as
        |     System.ServiceProces  -----  |--------o Window Service
        +----------------------------------+
        |  +----------------------------+  |
        |  |   Thread (Infinite)        |  | 
        |  +----------------------------+  |
        |  |  +----------------------+  |  |
        |  |  | MySchedulerService   |  |  | 
        |  |  +----------------------+  |  |
        |  |  | while ( true )       |  |  |
        |  |  | {                    |  |  |
        |  |  |    Task.Process()    |  |  |
        |  |  | }                    |  |  | 
        |  |  +----------------------+  |  | 
        |  +----------------------------+  |
        +----------------------------------+ 

            +------------+
            | ITask      |
            +------------+
            | Process()  |
            +------------+
                 /|\
                  |
        +------------------+
        |      BaseTask    |  -----------o Customized Task inherit BaseTask   
        +------------------+
        | lastProcessTime  | ------------o Last process time 
        | intervalTime     | ------------o Customize for next process time 
        | IsReadyProcess() | ------------o Check taks is ready to process 
        +------------------+

</code></pre>

<h5 id="create-customized-window-service">Create customized Window Service</h5>

<h5 id="use-serviceprocess-to-create-window-service">Use ServiceProcess to create Window Service</h5>

<ul>
<li>The System.ServiceProcess allow you to implement, install, and control Windows service applications. Services are long-running executables that run without a user interface.</li>
<li>The project must have main method the entry point</li>
</ul>

<pre><code class="language-cs">namespace MyScheduler
{
    using System.ServiceProcess;

    class Program
    {
        static void Main(string[] args)
        {
            #if DEBUG
                MySchedulerService debugService = new MySchedulerService();
                debugService.onDebug();
                System.Threading.Thread.Sleep(System.Threading.Timeout.Infinite);
            #else
                ServiceBase.Run(new ServiceBase[] { new MySchedulerService() });
            #endif
        }
    }
}

</code></pre>

<h5 id="create-customized-servicebase">Create customized ServiceBase</h5>

<ul>
<li>Implementing a service involves inheriting from the ServiceBase class and defining specific behavior to process when start, stop, pause, and continue commands are passed in, as well as custom behavior and actions to take when the system shuts down.</li>
</ul>

<pre><code class="language-cs">
namespace MyScheduler
{
    using System;
    using System.IO;
    using System.Collections.Generic;
    using System.Threading;

    public partial class MySchedulerService : System.ServiceProcess.ServiceBase
    {
        public const string START_SERVICE = &quot;start.service&quot;;
        public const string STOP_SERVICE = &quot;stop.service&quot;;

        public void onDebug()
        {
            OnStart(null);
        }

        protected override void OnStart(string[] args)
        {
            System.IO.File.Create(AppDomain.CurrentDomain.BaseDirectory 
                    + TART_SERVICE);
            ThreadStart tsTask = new ThreadStart(TaskLoop);
            Thread rtkTask = new Thread(tsTask);
            rtkTask.Start();
        }

        static void TaskLoop()
        {
            while (true)
            {
                // Exceute scheduled task
                ScheduledTask();
                // Then, wait for certain time interval
                System.Threading.Thread.Sleep(TimeSpan.FromMilliseconds(500));
            }
        }

        static void ScheduledTask()
        {
            // Task code which is executed periodically
            try
            {
                // Call customized tasks
                var types = Assembly.GetExecutingAssembly()
                                        .GetExportedTypes()
                                        .Where(p =&gt; typeof(ITask)
                                             .IsAssignableFrom(p.BaseType));

                foreach (var t in types)
                {
                    var task = (ITask)Activator.CreateInstance(t);
                    if (taskSettings.Keys.Contains(t.Name))
                    {
                        task.TaskSetting = taskSettings[t.Name];
                    }
                    tasks.Add(task);
                }
            }
            catch (Exception e)
            {
                // TO Something here               
            }
        }

        protected override void OnStop()
        {
            // Insert code here to close all the open IO or conection.
            System.IO.File.Create(AppDomain.CurrentDomain.BaseDirectory
                         + STOP_SERVICE);
        }

        private void InitializeComponent()
        {
            this.ServiceName = &quot;MySchedulerService&quot;;
        }

        protected override void Dispose(bool disposing)
        {
            OnStop();
            base.Dispose(disposing);
        }
    }
}

</code></pre>

<h5 id="task-interface-and-class">Task interface and class</h5>

<ul>
<li>interface ITask has only one method</li>
</ul>

<pre><code class="language-cs">namespace MyScheduler
{
    public interface ITask
    {
        void Process();
    }
}
</code></pre>

<ul>
<li>BaseTask</li>
</ul>

<pre><code class="language-cs">namespace MyScheduler
{
    using System;

    public class BaseTask : ITask
    {
        protected DateTime? lastProcessTime = null;

        // interval time uses second as unit
        // e.g. 1 min of intervaling time is 60 
        protected int intervalTime = 0 ;  

        protected bool IsReadyToProcess()
        {
            bool isReadyToProcess = true;

            if (lastProcessTime.HasValue)
            {
                if (lastProcessTime.Value.AddSeconds(intervalTime) &gt; DateTime.Now)
                {
                    isReadyToProcess = false;
                }
            } 
            return isReadyToProcess;
        }

        public virtual void Process()
        {
            throw new NotImplementedException();
        }
    }
}
</code></pre>

<ul>
<li>Sample Task1 and Task2</li>
</ul>

<p><strong>Task1</strong></p>

<pre><code class="language-cs">namespace MyScheduler
{
    using System;
    using System.Linq;
    using System.Data.Entity;

    public class Task1 : BaseTask
    {
        public override void Process()
        {
            if (base.IsReadyToProcess())
            {                
                System.IO.File.Create(AppDomain.CurrentDomain.BaseDirectory
                         + &quot;Task-1-&quot; + DateTime.Now.ToString(&quot;dd-MM-yyyy&quot;));
            }
        }
    }
}
</code></pre>

<p><strong>Task2</strong></p>

<pre><code class="language-cs">namespace MyScheduler
{
    using System;
    using System.Linq;
    using System.Data.Entity;

    public class Task2 : BaseTask
    {
        public override void Process()
        {
            if (base.IsReadyToProcess())
            {                
                System.IO.File.Create(AppDomain.CurrentDomain.BaseDirectory 
                        + &quot;Task-2-&quot; 
                        + DateTime.Now.ToString(&quot;dd-MM-yyyy&quot;));
            }
        }
    }
}
</code></pre>

<h4 id="create-window-service-installer">Create Window Service installer</h4>

<ul>
<li>In Solution Explorer, double-click MyScheduledService.cs.</li>
<li>In the Code Editor window, right-click <code>Design View</code>, and then click <code>Properties</code></li>
<li>In the <code>Properties</code> pane, click the <code>Add Installer</code> link.</li>
<li>In the Properties pane for MyScheduledServiceInstaller, change the <code>ServiceNameproperty</code> to <code>MyScheduledService</code>.</li>
<li>In the Code Editor window in <code>Design view</code>, click <code>MyScheduledServiceProcessInstaller</code>.</li>
<li>In the Properties pane, change the <code>Account</code> property to <code>LocalSystem</code> (The <code>LocalService</code> and <code>NetworkService</code> values are available only in Microsoft Windows XP).</li>
</ul>

<p><strong>PreInstaller</strong></p>

<ul>
<li>It inherits from System.Configuration.Install.Installer. This is the base class for all custom installers in the .NET Framework. Installers are components that help install applications on a computer.</li>
</ul>

<pre><code class="language-cs">namespace MyScheduler
{
    [RunInstaller(true)]
    public partial class ProjectInstaller : System.Configuration.Install.Installer
    {
        public ProjectInstaller()
        {
            InitializeComponent();
        }

        private void MySchedulerServiceInstaller_AfterInstall(
                object sender, InstallEventArgs e)
        {
        }
    }
}
</code></pre>

<h4 id="install-window-service">Install Window Service</h4>

<pre><code class="language-bash">C:\Windows\Microsoft.Net\Framework\v4.0.30319\InstallUtil.exe /i &lt;app_path&gt;\MyScheduler.exe 
</code></pre>

<h4 id="uninstall-window-service">Uninstall Window Service</h4>

<pre><code class="language-bash">C:\Windows\Microsoft.Net\Framework\v4.0.30319\InstallUtil.exe /u &lt;app_path&gt;\MyScheduler.exe 
</code></pre>


    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="/code/c-sharp/csharp-note-1/" title="C# Note - 1"> <i class="fa fa-chevron-left"></i><label>C# Note - 1</label></a>
    <a class="nav nav-next" href="/code/c-sharp/csharp-note-3/" title="C# Note - 3" style="margin-right: 0px;"><label>C# Note - 3</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    
    <div class="tags"> 
      
        <a class="label label-default" href="/tags/csharp">CSharp</a>
      
    </div>
    

    

    

    
  </div>


	
</footer>

<script src="/js/clipboard.min.js"></script>

<link href="/css/featherlight.min.css" rel="stylesheet">
<script src="/js/featherlight.min.js"></script>


<link href="/css/github.css" rel="stylesheet">
<script src="/js/highlight.pack.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>


<script src="/theme-flex/script.js"></script>

    

    
    

    
  </body>
</html>